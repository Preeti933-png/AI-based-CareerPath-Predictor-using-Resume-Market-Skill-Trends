<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ğŸ“Š Resume Analysis Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #skillChart {
            max-width: 200px;
            max-height: 200px;
        }
        .skill-badge {
            padding: 6px 12px;
            border-radius: 20px;
            margin: 4px;
            display: inline-block;
            font-weight: 500;
        }
        .matched-skill {
            background-color: #4CAF50; /* Green */
            color: white;
        }
        .missing-skill {
            background-color: #FF6384; /* Red */
            color: white;
        }
        .neutral-skill {
            background-color: #9E9E9E; /* Gray */
            color: white;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

<div class="container mt-5 mb-5">
    <h2 class="text-center mb-4">ğŸ“Š Resume Analysis Results</h2>

    {% if filename %}
    <h5>ğŸ“„ Uploaded File:</h5>
    <p class="fw-bold">{{ filename }}</p>
    <a href="{{ url_for('static', filename='resumes/' ~ filename) }}" download class="btn btn-outline-primary mb-3">â¬‡ï¸ Download </a>

    {% if filename.endswith('.pdf') %}
        <embed src="{{ url_for('static', filename='resumes/' ~ filename) }}" type="application/pdf" width="100%" height="500px" class="border mb-4"/>
    {% elif filename.endswith('.jpg') or filename.endswith('.jpeg') or filename.endswith('.png') %}
        <img src="{{ url_for('static', filename='resumes/' ~ filename) }}" class="img-fluid mb-4 border" alt="Uploaded Resume Image">
    {% else %}
        <p class="text-muted">ğŸ“‚ Preview not available for DOCX. Please download to view.</p>
    {% endif %}
    {% endif %}

    {% if skills %}
        <!-- Skills Extracted -->
        <h5 class="mt-4"> Extracted Skills from Resume:</h5>
        <div class="mb-4">
           {% for skill in skills %}
           {% if skill.lower() in matched_skills %}
              <span class="skill-badge matched-skill">âœ… {{ skill }}</span>
           {% elif skill.lower() in missing_skills %}
              <span class="skill-badge missing-skill">âŒ {{ skill }}</span>
          {% else %}
              <span class="skill-badge neutral-skill">{{ skill }}</span>
          {% endif %}
          {% endfor %}

        </div>
    {% else %}
        <p class="text-danger">No skills were extracted from your resume.</p>
    {% endif %}

    <!-- Skill Gap -->
    <h5 class="mt-4"> Skill Gap Recommendations:</h5>
    {% if recommendations %}
        <div class="d-flex justify-content-center mb-3">
            <canvas id="skillChart" width="250" height="250"></canvas>
        </div>
        <ul class="list-group mb-4">
            {% for rec in recommendations %}
                <li class="list-group-item">
                    <strong>{{ rec.skill }}</strong> â€“ Learn:
                    <a href="{{ rec.coursera }}" target="_blank">Coursera</a>,
                    <a href="{{ rec.udemy }}" target="_blank">Udemy</a> ,
                    <a href="{{ rec.youtube }}" target="_blank">YouTube</a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-success">ğŸ‰ Great! You already have all the required skills for your dream job role.</p>
    {% endif %}

    {% if top_roles %}
        <!-- Job Role Suggestions -->
        <h5 class="mt-4">ğŸ’¼ Suggested Job Roles Based on Your Skills:</h5>
        <ul class="list-group mb-4">
            {% for role in top_roles %}
                <li class="list-group-item">{{ role }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <div class="mt-4 text-center">
        <a href="/" class="btn btn-secondary">ğŸ”™ Back to Home</a>
    </div>
</div>

<!-- Pie Chart Script -->
{% if recommendations %}
<script>
    const ctx = document.getElementById('skillChart').getContext('2d');
    const skillChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Matched Skills', 'Missing Skills'],
            datasets: [{
                data: [{{ match_count }}, {{ missing_count }}],
                backgroundColor: ['#4CAF50', '#FF6384'],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
</script>
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
